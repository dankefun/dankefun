{"version":3,"sources":["webpack:///./packages/story/StoryManage.vue?5759","webpack:///./packages/story/AlbumManage.vue?10d2","webpack:///packages/story/AlbumManage.vue","webpack:///./packages/story/AlbumManage.vue?fe13","webpack:///./packages/story/AlbumManage.vue","webpack:///./packages/story/StoryManage.vue?29bc","webpack:///packages/story/StoryManage.vue","webpack:///./packages/story/StoryManage.vue?8e54","webpack:///./packages/story/StoryManage.vue","webpack:///./packages/common/dao/restdao.js"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_StoryManage_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_StoryManage_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","attrs","id","_m","_l","album","key","_id","staticClass","directives","name","rawName","value","expression","staticStyle","width","domProps","on","input","$event","target","composing","$set","_v","_s","stories","type","checked","Array","isArray","today","_i","change","$$a","$$el","$$c","$$v","$$i","concat","slice","click","saveAlbum","deleteAlbum","staticRenderFns","AlbumManagevue_type_script_lang_js_","data","albums","mounted","albumdao","restdao","ctx","storydao","loadCurrentPage","methods","_loadCurrentPage","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","result","wrap","_context","prev","next","list","sort","order","page","count","sent","stop","apply","arguments","_saveAlbum","_callee2","_context2","regex","patch","cover","desc","length","t0","_x","_deleteAlbum","_callee3","story","_context3","_x2","story_AlbumManagevue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","src","currentPlaying","controls","loop","autoplay","_e","titleSearch","searchStory","albumSearch","searchByAlbum","pathSearch","searchByPath","jumpPage","modifiers","number","currentPage","_n","blur","$forceUpdate","deleteAll","deleteRemoved","saveStory","playStory","deleteStory","deleted","path","StoryManagevue_type_script_lang_js_","CDN_IMG","pageToGo","queryText","showRelatedStory","showSearchDialog","relatedStories","pageSize","total","tableData","loading","dialogFormVisible","created","_searchStory","_searchByAlbum","_searchByPath","inc","_callee4","_context4","_saveStory","_callee5","_context5","title","label","teller","_playStory","_callee6","_context6","_deleteStory","_callee7","_context7","_x3","_deleteAll","_callee8","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","_context8","undefined","Symbol","iterator","done","sleep","return","finish","_deleteRemoved","_callee9","json","_context9","ky","get","_sleep","_callee10","mill","_context10","abrupt","Promise","resolve","reject","setTimeout","_x4","story_StoryManagevue_type_script_lang_js_","RestDAO","D_github_danke_node_modules_babel_runtime_corejs2_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","obj","str","p","hasOwnProperty","push","encodeURIComponent","join","filter","serialize","o","post","put","prop","limit","delete"],"mappings":"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","file":"js/story-manage.864f9bb3.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryManage.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryManage.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"album-manage\"}},[_c('table',[_vm._m(0),_vm._l((_vm.albums),function(album){return _c('tr',{key:album._id,staticClass:\"one-album\"},[_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(album.name),expression:\"album.name\"}],staticStyle:{\"width\":\"300px\"},domProps:{\"value\":(album.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(album, \"name\", $event.target.value)}}})]),_c('td',[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(album.cover),expression:\"album.cover\"}],domProps:{\"value\":(album.cover)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(album, \"cover\", $event.target.value)}}})]),_c('td',[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(album.desc),expression:\"album.desc\"}],staticStyle:{\"width\":\"300px\"},domProps:{\"value\":(album.desc)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(album, \"desc\", $event.target.value)}}})]),_c('td',[_vm._v(_vm._s(album.stories)),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(album.today),expression:\"album.today\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(album.today)?_vm._i(album.today,null)>-1:(album.today)},on:{\"change\":function($event){var $$a=album.today,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(album, \"today\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(album, \"today\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(album, \"today\", $$c)}}}})]),_c('td',[_c('a',{on:{\"click\":function($event){return _vm.saveAlbum(album)}}},[_vm._v(\"更新\")]),_c('a',{on:{\"click\":function($event){return _vm.deleteAlbum(album)}}},[_vm._v(\"删除\")])])])})],2)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('tr',[_c('th',[_vm._v(\"名称\")]),_c('th',[_vm._v(\"cover\")]),_c('th',[_vm._v(\"描述\")]),_c('th',[_vm._v(\"推荐\")]),_c('th',{staticStyle:{\"width\":\"120px\"}},[_vm._v(\"操作\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"album-manage\">\r\n    <table>\r\n        <tr>\r\n          <th>名称</th>\r\n          <th>cover</th>\r\n          <th>描述</th>\r\n          <th>推荐</th>\r\n          <th style=\"width: 120px\">操作</th>\r\n        </tr>\r\n        <tr class=\"one-album\" v-for=\"album in albums\" :key=\"album._id\">\r\n          <td><input style=\"width: 300px;\" v-model=\"album.name\"></td>\r\n          <td><textarea v-model=\"album.cover\"></textarea></td>\r\n          <td><textarea style=\"width: 300px;\" v-model=\"album.desc\"></textarea></td>\r\n          <td>{{album.stories}}<input type=\"checkbox\" v-model=\"album.today\"></td>\r\n          <td>\r\n            <a @click=\"saveAlbum(album)\">更新</a>\r\n            <a @click=\"deleteAlbum(album)\">删除</a>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport RestDAO from '../common/dao/restdao.js'\r\nexport default {\r\n  data () {\r\n    return {\r\n      albums: []\r\n    }\r\n  },\r\n  mounted () {\r\n    this.albumdao = new RestDAO(this.ctx, 'ybstory/album')\r\n    this.storydao = new RestDAO(this.ctx, 'ybstory/story')\r\n    this.loadCurrentPage()\r\n  },\r\n  methods: {\r\n    async loadCurrentPage () {\r\n      const result = await this.albumdao.list({\r\n        sort: 'u',\r\n        order: '-1',\r\n        page: 1,\r\n        count: 10000\r\n      })\r\n      this.albums = result.list\r\n    },\r\n    async saveAlbum (album) {\r\n      try {\r\n        const stories = await this.storydao.regex('album', album.name)\r\n        await this.albumdao.patch(album._id, {\r\n          cover: album.cover,\r\n          desc: album.desc,\r\n          stories: stories.result.length\r\n        })\r\n      } catch (e) {\r\n      }\r\n    },\r\n    async deleteAlbum (story) {\r\n      await this.ctx.storydao.deleteAlbum(story)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlbumManage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlbumManage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlbumManage.vue?vue&type=template&id=05b0cac4&\"\nimport script from \"./AlbumManage.vue?vue&type=script&lang=js&\"\nexport * from \"./AlbumManage.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"story-manage\"},[(_vm.currentPlaying)?_c('div',{staticClass:\"play\"},[_c('audio',{attrs:{\"src\":_vm.currentPlaying,\"controls\":\"controls\",\"loop\":\"loop\",\"autoplay\":\"autoplay\"}})]):_vm._e(),_c('div',{staticClass:\"query\"},[_c('div',[_vm._v(\"\\n      标题 \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.titleSearch),expression:\"titleSearch\"}],domProps:{\"value\":(_vm.titleSearch)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.titleSearch=$event.target.value}}}),_c('a',{on:{\"click\":_vm.searchStory}},[_vm._v(\"搜索\")]),_vm._v(\"\\n      专辑 \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.albumSearch),expression:\"albumSearch\"}],domProps:{\"value\":(_vm.albumSearch)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.albumSearch=$event.target.value}}}),_c('a',{on:{\"click\":_vm.searchByAlbum}},[_vm._v(\"搜索\")]),_vm._v(\"\\n      路径 \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.pathSearch),expression:\"pathSearch\"}],domProps:{\"value\":(_vm.pathSearch)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.pathSearch=$event.target.value}}}),_c('a',{on:{\"click\":_vm.searchByPath}},[_vm._v(\"搜索\")])])]),_c('div',{staticClass:\"pager\"},[_c('a',{on:{\"click\":function($event){return _vm.jumpPage(-1)}}},[_vm._v(\"上页\")]),_c('a',{on:{\"click\":function($event){return _vm.jumpPage(1)}}},[_vm._v(\"下页\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.currentPage),expression:\"currentPage\",modifiers:{\"number\":true}}],domProps:{\"value\":(_vm.currentPage)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.currentPage=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('a',{on:{\"click\":function($event){return _vm.jumpPage(0)}}},[_vm._v(\"跳转\")]),_c('a',{on:{\"click\":_vm.deleteAll}},[_vm._v(\"全部删除\")]),_c('a',{on:{\"click\":_vm.deleteRemoved}},[_vm._v(\"删除标记故事\")])]),_c('div',{staticClass:\"story-list\"},[_c('table',[_vm._m(0),_vm._l((_vm.tableData),function(story){return _c('tr',{key:story._id,staticClass:\"one-story\"},[_c('td',[_c('a',{on:{\"click\":function($event){return _vm.saveStory(story)}}},[_vm._v(\"更新\")]),_c('a',{on:{\"click\":function($event){return _vm.playStory(story)}}},[_vm._v(\"播放\")]),_c('a',{on:{\"click\":function($event){return _vm.deleteStory(story)}}},[_vm._v(\"删除\")])]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(story.title),expression:\"story.title\"}],staticStyle:{\"width\":\"300px\"},domProps:{\"value\":(story.title)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(story, \"title\", $event.target.value)}}})]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(story.album),expression:\"story.album\"}],domProps:{\"value\":(story.album)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(story, \"album\", $event.target.value)}}})]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(story.label),expression:\"story.label\"}],domProps:{\"value\":(story.label)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(story, \"label\", $event.target.value)}}})]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(story.teller),expression:\"story.teller\"}],domProps:{\"value\":(story.teller)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(story, \"teller\", $event.target.value)}}})]),_c('td',[_vm._v(_vm._s(story.deleted)+\"-\"+_vm._s(story.path))])])})],2)]),_c('div',{staticClass:\"pager\"},[_c('a',{on:{\"click\":function($event){return _vm.jumpPage(-1)}}},[_vm._v(\"上页\")]),_c('a',{on:{\"click\":function($event){return _vm.jumpPage(1)}}},[_vm._v(\"下页\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.currentPage),expression:\"currentPage\",modifiers:{\"number\":true}}],domProps:{\"value\":(_vm.currentPage)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.currentPage=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('a',{on:{\"click\":function($event){return _vm.jumpPage(0)}}},[_vm._v(\"跳转\")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('tr',[_c('th',{staticStyle:{\"width\":\"160px\"}},[_vm._v(\"操作\")]),_c('th',[_vm._v(\"标题\")]),_c('th',[_vm._v(\"专辑\")]),_c('th',[_vm._v(\"标签\")]),_c('th',[_vm._v(\"主播\")]),_c('th',{},[_vm._v(\"路径\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"story-manage\">\r\n    <div class=\"play\" v-if=\"currentPlaying\">\r\n      <audio :src=\"currentPlaying\" controls=\"controls\" loop=\"loop\" autoplay=\"autoplay\"></audio>\r\n    </div>\r\n    <div class=\"query\">\r\n      <div>\r\n        标题 <input v-model=\"titleSearch\"> <a @click=\"searchStory\">搜索</a>\r\n        专辑 <input v-model=\"albumSearch\"> <a @click=\"searchByAlbum\">搜索</a>\r\n        路径 <input v-model=\"pathSearch\"> <a @click=\"searchByPath\">搜索</a>\r\n      </div>\r\n    </div>\r\n    <div class=\"pager\">\r\n      <a @click=\"jumpPage(-1)\">上页</a>\r\n      <a @click=\"jumpPage(1)\">下页</a>\r\n      <input v-model.number=\"currentPage\">\r\n      <a @click=\"jumpPage(0)\">跳转</a>\r\n      <a @click=\"deleteAll\">全部删除</a>\r\n      <a @click=\"deleteRemoved\">删除标记故事</a>\r\n    </div>\r\n    <div class=\"story-list\">\r\n      <table>\r\n        <tr>\r\n          <th style=\"width: 160px\">操作</th>\r\n          <th>标题</th>\r\n          <th>专辑</th>\r\n          <th>标签</th>\r\n          <th>主播</th>\r\n          <th style=\"\">路径</th>\r\n        </tr>\r\n        <tr class=\"one-story\" v-for=\"story in tableData\" :key=\"story._id\">\r\n          <td>\r\n            <a @click=\"saveStory(story)\">更新</a>\r\n            <a @click=\"playStory(story)\">播放</a>\r\n            <a @click=\"deleteStory(story)\">删除</a>\r\n          </td>\r\n          <td><input style=\"width: 300px;\" v-model=\"story.title\"></td>\r\n          <td><input v-model=\"story.album\"></td>\r\n          <td><input v-model=\"story.label\"></td>\r\n          <td><input v-model=\"story.teller\"></td>\r\n          <td>{{story.deleted}}-{{story.path}}</td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n    <div class=\"pager\">\r\n      <a @click=\"jumpPage(-1)\">上页</a>\r\n      <a @click=\"jumpPage(1)\">下页</a>\r\n      <input v-model.number=\"currentPage\">\r\n      <a @click=\"jumpPage(0)\">跳转</a>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport RestDAO from '../common/dao/restdao.js'\r\nexport default {\r\n  data: function () {\r\n    return {\r\n      CDN_IMG: 'http://imagek.cdn.bcebos.com',\r\n      titleSearch: '',\r\n      albumSearch: '',\r\n      pathSearch: '',\r\n      pageToGo: '',\r\n      queryText: '',\r\n      showRelatedStory: false,\r\n      showSearchDialog: false,\r\n      relatedStories: [],\r\n      currentPage: 1,\r\n      pageSize: 50,\r\n      total: 0,\r\n      tableData: [],\r\n      loading: false,\r\n      currentPlaying: null,\r\n      dialogFormVisible: false,\r\n    }\r\n  },\r\n\r\n  created () {\r\n    this.storydao = new RestDAO (this.ctx, 'ybstory/story')\r\n  },\r\n  mounted () {\r\n    this.loadCurrentPage()\r\n  },\r\n  methods: {\r\n    async searchStory () {\r\n      const result = await this.storydao.regex('title', this.titleSearch)\r\n      this.tableData = result.result\r\n    },\r\n    async searchByAlbum () {\r\n      const result = await this.storydao.regex('album', this.albumSearch)\r\n      this.tableData = result.result\r\n    },\r\n    async searchByPath () {\r\n      const result = await this.storydao.regex('path', this.pathSearch)\r\n      this.tableData = result.result\r\n    },\r\n    jumpPage (inc) {\r\n      this.currentPage += inc\r\n      this.loadCurrentPage()\r\n    },\r\n    async loadCurrentPage () {\r\n      this.loading = true\r\n      const result = await this.storydao.list({\r\n        page: this.currentPage,\r\n        count: this.pageSize\r\n      })\r\n      this.loading = false\r\n      this.tableData = result.list\r\n      this.total = result.total\r\n    },\r\n    async saveStory (story) {\r\n      try {\r\n        await this.storydao.patch(story._id, {\r\n          title: story.title,\r\n          album: story.album,\r\n          label: story.label,\r\n          teller: story.teller\r\n        })\r\n      } catch (e) {\r\n      }\r\n    },\r\n    async playStory (story) {\r\n      this.currentPlaying = 'http://chuchu.cdn.bcebos.com/' + story.path\r\n    },\r\n    async deleteStory (story) {\r\n      await this.storydao.patch(story._id, {\r\n        deleted: true\r\n      })\r\n    },\r\n\r\n    async deleteAll () {\r\n      for (let story of this.tableData) {\r\n        await this.deleteStory(story)\r\n        await this.sleep(100)\r\n      }\r\n    },\r\n\r\n    async deleteRemoved () {\r\n      let json = await this.ctx.ky.get('story/delete/one').json()\r\n      while (json.path) {\r\n        await this.sleep(500)\r\n        json = await this.ctx.ky.get('story/delete/one').json()\r\n      }\r\n    },\r\n    async sleep(mill) {\r\n      return new Promise((resolve, reject) => {\r\n        setTimeout(()=>{\r\n          resolve()\r\n        }, mill)\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nbody {\r\n  background: #fff;\r\n}\r\n.pager {\r\n  a {\r\n    margin: 0 5px;\r\n  }\r\n  input {\r\n    width: 50px;\r\n  }\r\n}\r\n.story-list {\r\n  a {\r\n    margin: 0 5px;\r\n  }\r\n  tr:hover {\r\n    background-color: #bbb;\r\n    input {\r\n      background: transparent;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryManage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryManage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StoryManage.vue?vue&type=template&id=675bb350&\"\nimport script from \"./StoryManage.vue?vue&type=script&lang=js&\"\nexport * from \"./StoryManage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./StoryManage.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default class RestDAO {\r\n  constructor (ctx, path) {\r\n    this.ctx = ctx\r\n    this.path = path\r\n  }\r\n\r\n  serialize (obj) {\r\n    var str = []\r\n    for (var p in obj) {\r\n      if (obj.hasOwnProperty(p)) {\r\n        str.push(encodeURIComponent(p) + '=' + encodeURIComponent(obj[p]))\r\n      }\r\n    }\r\n    return str.join('&')\r\n  }\r\n  async getOne (id) {\r\n    const result = await this.ctx.get(`${this.path}/${id}`).json()\r\n    return result\r\n  }\r\n\r\n  async list (filter) {\r\n    const result = await this.ctx.get(`${this.path}?${this.serialize(filter)}`).json()\r\n    return result\r\n  }\r\n\r\n  async create (o) {\r\n    await this.ctx.post(`${this.path}`, {\r\n      json: o\r\n    })\r\n  }\r\n\r\n  async update (id, json) {\r\n    await this.ctx.ky.put(`${this.path}/${id}`, {\r\n      json\r\n    })\r\n  }\r\n\r\n  async regex (prop, value, limit) {\r\n    const result = await this.ctx.get(`${this.path}/regex/${prop}/${value}?limit=${limit || 1000}`, {}).json()\r\n    return result\r\n  }\r\n\r\n  async patch (id, json) {\r\n    await this.ctx.ky.patch(`${this.path}/${id}`, {\r\n      json\r\n    })\r\n  }\r\n\r\n  async delete (o) {\r\n    const result = await this.ctx.delete(`${this.path}/${o._id}`).json()\r\n    return result\r\n  }\r\n}\r\n"],"sourceRoot":""}