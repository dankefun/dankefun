(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{"0390":function(t,e,a){"use strict";var s=a("02f4")(!0);t.exports=function(t,e,a){return e+(a?s(t,e).length:1)}},"0a20":function(t,e,a){},"214f":function(t,e,a){"use strict";a("b0c5");var s=a("2aba"),r=a("32e9"),n=a("79e5"),i=a("be13"),c=a("2b4c"),o=a("520a"),l=c("species"),u=!n(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),v=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var a="ab".split(t);return 2===a.length&&"a"===a[0]&&"b"===a[1]}();t.exports=function(t,e,a){var d=c(t),p=!n(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),h=p?!n(function(){var e=!1,a=/a/;return a.exec=function(){return e=!0,null},"split"===t&&(a.constructor={},a.constructor[l]=function(){return a}),a[d](""),!e}):void 0;if(!p||!h||"replace"===t&&!u||"split"===t&&!v){var f=/./[d],m=a(i,d,""[t],function(t,e,a,s,r){return e.exec===o?p&&!r?{done:!0,value:f.call(e,a,s)}:{done:!0,value:t.call(a,e,s)}:{done:!1}}),g=m[0],b=m[1];s(String.prototype,t,g),r(RegExp.prototype,d,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}}},"27c2":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("nav-bar"),a("section",{staticClass:"login-panel box"},[a("h1",{staticClass:"title"},[t._v("注册")]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("手机号")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"input",class:t.error.username?"is-danger":"",attrs:{type:"text",placeholder:"输入手机号码"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t.error.username?a("p",{staticClass:"help is-danger"},[t._v(t._s(t.error.username))]):t._e()]),a("div",{staticClass:"field"},[t._m(0),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nickname,expression:"nickname"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.nickname},on:{input:function(e){e.target.composing||(t.nickname=e.target.value)}}})])]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("密码")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"input",class:t.error.password?"is-danger":"",attrs:{type:"password",placeholder:"输入密码"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t.error.password?a("p",{staticClass:"help is-danger"},[t._v(t._s(t.error.password))]):t._e()]),a("div",{staticClass:"field"},[a("div",{staticClass:"control"},[a("label",{staticClass:"checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?t._i(t.checked,null)>-1:t.checked},on:{change:function(e){var a=t.checked,s=e.target,r=!!s.checked;if(Array.isArray(a)){var n=null,i=t._i(a,n);s.checked?i<0&&(t.checked=a.concat([n])):i>-1&&(t.checked=a.slice(0,i).concat(a.slice(i+1)))}else t.checked=r}}}),t._v("\n          同意"),a("a",{attrs:{href:"#"}},[t._v("danke.fun 使用条款")])])])]),a("div",{staticClass:"field is-grouped"},[a("div",{staticClass:"control"},[a("button",{staticClass:"button is-success",attrs:{disabled:!t.checked},on:{click:t.doRegister}},[t._v("注册")])]),t._m(1)])])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"label"},[t._v("用户名 "),a("span",{staticClass:"is-small"},[t._v("(可选)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"control"},[a("button",{staticClass:"button is-text"},[t._v("忘记密码")])])}],n=(a("a481"),a("96cf"),a("3b8d")),i=a("7944"),c={name:"Register",components:{NavBar:i["a"]},data:function(){return{username:"",checked:!0,error:{nickname:"",username:"",password:""},password:""}},created:function(){var t=this;setInterval(function(){0!==t.countDown&&t.countDown--},1e3)},methods:{doRegister:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!==this.username){t.next=3;break}return this.error.username="请输入用户名",t.abrupt("return");case 3:if(""!==this.password){t.next=6;break}return this.error.password="请输入密码",t.abrupt("return");case 6:return t.next=8,this.ctx.userdao.register(this.username,this.password,this.nickname);case 8:if(e=t.sent,400!==e.code){t.next=12;break}return this.error.username="手机号码格式不正确",t.abrupt("return");case 12:if(409!==e.code){t.next=15;break}return this.error.username="手机号码已经注册过",t.abrupt("return");case 15:e.token&&localStorage.setItem("token",e.token),this.$router.replace("/");case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},o=c,l=(a("6f3e"),a("2877")),u=Object(l["a"])(o,s,r,!1,null,null,null);e["default"]=u.exports},"3bba":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"user-profile"}},[a("nav-bar"),a("section",{staticClass:"section"},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column user-profile is-one-quarter"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-image file"},[a("figure",{staticClass:"file-label image is-square user-avatar"},[a("img",{attrs:{src:t.user.avatar||"http://cdn.danke.fun/res/head.svg",alt:""}}),a("input",{staticClass:"file-input",attrs:{type:"file"}})])]),a("div",{staticClass:"card-content"},[a("div",{staticClass:"media"},[a("div",{staticClass:"media-content"},[a("p",{staticClass:"title is-4"},[t._v("John Smith")]),a("p",{staticClass:"subtitle is-6"},[t._v("账号: "+t._s(t.user.id))])])]),t._m(0)])])]),a("div",{staticClass:"column"},[t._v("\r\n          bb\r\n        ")])])])])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._v("\r\n                Lorem ipsum dolor sit amet, consectetur adipiscing elit.\r\n                Phasellus nec iaculis mauris. "),a("a",[t._v("@bulmaio")]),t._v(".\r\n                "),a("a",{attrs:{href:"#"}},[t._v("#css")]),a("a",{attrs:{href:"#"}},[t._v("#responsive")]),a("br"),a("time",{attrs:{datetime:"2016-1-1"}},[t._v("11:09 PM - 1 Jan 2016")])])}],n=a("7944"),i={name:"UserHome",components:{NavBar:n["a"]},data:function(){return{user:this.ctx.user}},created:function(){}},c=i,o=(a("521a"),a("2877")),l=Object(o["a"])(c,s,r,!1,null,null,null);e["default"]=l.exports},4801:function(t,e,a){},"520a":function(t,e,a){"use strict";var s=a("0bfb"),r=RegExp.prototype.exec,n=String.prototype.replace,i=r,c="lastIndex",o=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t[c]||0!==e[c]}(),l=void 0!==/()??/.exec("")[1],u=o||l;u&&(i=function(t){var e,a,i,u,v=this;return l&&(a=new RegExp("^"+v.source+"$(?!\\s)",s.call(v))),o&&(e=v[c]),i=r.call(v,t),o&&i&&(v[c]=v.global?i.index+i[0].length:e),l&&i&&i.length>1&&n.call(i[0],a,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(i[u]=void 0)}),i}),t.exports=i},"521a":function(t,e,a){"use strict";var s=a("0a20"),r=a.n(s);r.a},"5f1b":function(t,e,a){"use strict";var s=a("23c6"),r=RegExp.prototype.exec;t.exports=function(t,e){var a=t.exec;if("function"===typeof a){var n=a.call(t,e);if("object"!==typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==s(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},"6f3e":function(t,e,a){"use strict";var s=a("b790"),r=a.n(s);r.a},7944:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"navbar is-fixed-top",attrs:{role:"navigation","aria-label":"main navigation"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"navbar-brand"},[t._m(0),a("a",{staticClass:"navbar-burger burger",class:t.burgerOpen,attrs:{role:"button","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"},on:{click:t.toggleOpen}},[a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"navbar-menu",class:t.burgerOpen,attrs:{id:"navbarBasicExample"}},[a("div",{staticClass:"navbar-start"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[t._v("首页")]),a("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[a("a",{staticClass:"navbar-link"},[t._v("\n            工具\n          ")]),a("div",{staticClass:"navbar-dropdown"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/frame-list"}},[t._v("动画")]),a("router-link",{staticClass:"navbar-item",attrs:{to:"/scenes"}},[t._v("页面")]),a("router-link",{staticClass:"navbar-item",attrs:{to:"/slide-tool"}},[t._v("展示")])],1)]),a("a",{staticClass:"navbar-item",attrs:{href:"/story"}},[t._v("\n          元宝故事\n        ")])],1),a("div",{staticClass:"navbar-end"},[t.avatar?t._e():a("div",{staticClass:"navbar-item"},[a("div",{staticClass:"buttons"},[a("router-link",{staticClass:"button is-primary",attrs:{to:"/register"}},[a("strong",[t._v("注册")])]),a("router-link",{staticClass:"button is-light",attrs:{to:"/login"}},[t._v("登录")])],1)]),t.avatar?a("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[a("a",{staticClass:"navbar-link is-arrowless"},[a("figure",{staticClass:"image is-32x32",on:{click:t.goUserHome}},[a("img",{staticStyle:{"max-height":"48px!important"},attrs:{src:t.avatar,width:"48",height:"48"}})])]),a("div",{staticClass:"navbar-dropdown is-right"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/user"}},[t._v("\n              个人信息\n            ")]),a("a",{staticClass:"navbar-item"},[t._v("\n              我的页面\n            ")]),a("a",{staticClass:"navbar-item"},[t._v("\n              我的展示\n            ")]),a("hr",{staticClass:"navbar-divider"}),a("a",{staticClass:"navbar-item",on:{click:t.logout}},[t._v("\n              退出\n            ")])],1)]):t._e()])])])])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"navbar-item",attrs:{href:"/"}},[a("img",{attrs:{src:"//cdn.danke.fun/res/logo-light.png"}})])}],n=a("bd37"),i={name:"NavBar",props:{},data:function(){return{user:this.ctx.user,isMobileOpened:!1}},created:function(){var t=this;this.ctx.on&&this.ctx.on("user-updated",function(e){t.user=e})},computed:{burgerOpen:function(){return this.isMobileOpened?"is-active":""},avatar:function(){return this.user&&this.user.id?this.user.avatar||this.ctx.cdn+"/res/head.svg":null}},mounted:function(){var t=this;this.$router.beforeEach(function(e,a,s){t.isMobileOpened=!1,s()})},methods:{logout:function(){this.ctx.token=Object(n["b"])(),this.ctx.user=null,this.ctx.emit("user-updated",null),this.$router.push("/")},toggleOpen:function(){this.isMobileOpened=!this.isMobileOpened},getStarted:function(){this.$router.push("/user")},goUserHome:function(){this.$router.push("/user")}}},c=i,o=a("2877"),l=Object(o["a"])(c,s,r,!1,null,null,null);e["a"]=l.exports},a481:function(t,e,a){"use strict";var s=a("cb7c"),r=a("4bf8"),n=a("9def"),i=a("4588"),c=a("0390"),o=a("5f1b"),l=Math.max,u=Math.min,v=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};a("214f")("replace",2,function(t,e,a,f){return[function(s,r){var n=t(this),i=void 0==s?void 0:s[e];return void 0!==i?i.call(s,n,r):a.call(String(n),s,r)},function(t,e){var r=f(a,t,this,e);if(r.done)return r.value;var v=s(t),d=String(this),p="function"===typeof e;p||(e=String(e));var g=v.global;if(g){var b=v.unicode;v.lastIndex=0}var C=[];while(1){var x=o(v,d);if(null===x)break;if(C.push(x),!g)break;var _=String(x[0]);""===_&&(v.lastIndex=c(d,n(v.lastIndex),b))}for(var w="",k=0,y=0;y<C.length;y++){x=C[y];for(var $=String(x[0]),E=l(u(i(x.index),d.length),0),O=[],R=1;R<x.length;R++)O.push(h(x[R]));var P=x.groups;if(p){var S=[$].concat(O,E,d);void 0!==P&&S.push(P);var N=String(e.apply(void 0,S))}else N=m($,d,E,O,P,e);E>=k&&(w+=d.slice(k,E)+N,k=E+$.length)}return w+d.slice(k)}];function m(t,e,s,n,i,c){var o=s+t.length,l=n.length,u=p;return void 0!==i&&(i=r(i),u=d),a.call(c,u,function(a,r){var c;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,s);case"'":return e.slice(o);case"<":c=i[r.slice(1,-1)];break;default:var u=+r;if(0===u)return a;if(u>l){var d=v(u/10);return 0===d?a:d<=l?void 0===n[d-1]?r.charAt(1):n[d-1]+r.charAt(1):a}c=n[u-1]}return void 0===c?"":c})}})},b0c5:function(t,e,a){"use strict";var s=a("520a");a("5ca1")({target:"RegExp",proto:!0,forced:s!==/./.exec},{exec:s})},b790:function(t,e,a){},d0f4:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("nav-bar"),a("section",{staticClass:"login-panel box"},[a("h1",{staticClass:"title"},[t._v("登录")]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("用户名")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"input",attrs:{type:"text",placeholder:"输入用户名"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t.error.username?a("p",{staticClass:"help is-danger"},[t._v("用户名或密码不正确")]):t._e()]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("密码")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"input",attrs:{type:"password",placeholder:"输入密码"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("验证码")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.captcha,expression:"captcha"}],staticClass:"input captcha",domProps:{value:t.captcha},on:{input:function(e){e.target.composing||(t.captcha=e.target.value)}}}),a("span",{domProps:{innerHTML:t._s(t.svg)},on:{click:t.refreshCaptcha}})]),a("div",{staticClass:"control"}),t.error.captcha?a("p",{staticClass:"help is-danger"},[t._v(t._s(t.error.captcha))]):t._e()]),a("div",{staticClass:"field is-grouped"},[a("div",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:t.login}},[t._v("登录")])]),a("div",{staticClass:"control"},[a("button",{staticClass:"button is-text",on:{click:t.register}},[t._v("注册")])])])])],1)},r=[],n=(a("a481"),a("96cf"),a("3b8d")),i=a("7944"),c={name:"Home",components:{NavBar:i["a"]},data:function(){return{error:{captcha:"",username:""},captcha:"",svg:"",username:"",password:""}},created:function(){var t=this;setInterval(function(){0!==t.countDown&&t.countDown--},1e3)},mounted:function(){this.refreshCaptcha()},methods:{refreshCaptcha:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ctx.userdao.getCaptcha();case 2:e=t.sent,this.svg=e.svg;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),register:function(){this.$router.push("/register")},login:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ctx.userdao.login(this.username,this.password,this.captcha);case 2:e=t.sent,400===e.code&&(this.error.captcha="验证码不正确",this.refreshCaptcha()),401===e.code&&(this.error.captcha="",this.error.username=e.message,this.captcha="",this.refreshCaptcha()),200===e.code&&(this.ctx.toPath?(this.$router.replace(this.ctx.toPath),this.ctx.toPath=null):this.$router.replace("/"));case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},o=c,l=(a("ec86"),a("2877")),u=Object(l["a"])(o,s,r,!1,null,null,null);e["default"]=u.exports},ec86:function(t,e,a){"use strict";var s=a("4801"),r=a.n(s);r.a}}]);
//# sourceMappingURL=user.60693463.js.map